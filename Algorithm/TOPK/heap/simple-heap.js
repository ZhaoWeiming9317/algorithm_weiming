/**
 * è¶…ç®€åŒ–å †å®ç° - é¢è¯•èƒŒè¯µç‰ˆæœ¬
 * åªä¿ç•™æ ¸å¿ƒåŠŸèƒ½ï¼Œæ˜“äºè®°å¿†
 * 
 * å †çš„æ ¸å¿ƒåŸç†ï¼š
 * 1. å®Œå…¨äºŒå‰æ ‘ï¼šç”¨æ•°ç»„å­˜å‚¨ï¼Œæ»¡è¶³å®Œå…¨äºŒå‰æ ‘çš„æ€§è´¨
 * 2. å †åºæ€§è´¨ï¼šçˆ¶èŠ‚ç‚¹æ€»æ˜¯å¤§äºï¼ˆæœ€å¤§å †ï¼‰æˆ–å°äºï¼ˆæœ€å°å †ï¼‰å­èŠ‚ç‚¹
 * 3. æ•°ç»„ç´¢å¼•å…³ç³»ï¼š
 *    - çˆ¶èŠ‚ç‚¹ç´¢å¼•: Math.floor((index - 1) / 2)
 *    - å·¦å­èŠ‚ç‚¹ç´¢å¼•: 2 * index + 1
 *    - å³å­èŠ‚ç‚¹ç´¢å¼•: 2 * index + 2
 */

class SimpleHeap {
  constructor(isMinHeap = true) {
    this.heap = [];                    // ç”¨æ•°ç»„å­˜å‚¨å †
    this.isMinHeap = isMinHeap;        // true: æœ€å°å †, false: æœ€å¤§å †
  }

  /**
   * è·å–å †çš„å¤§å°
   * ä¸ºä»€ä¹ˆç”¨ getterï¼Ÿå› ä¸º size æ˜¯åŠ¨æ€è®¡ç®—çš„å±æ€§
   */
  get size() {
    return this.heap.length;
  }

  /**
   * åˆ¤æ–­å †æ˜¯å¦ä¸ºç©º
   * ç©ºå †ä¸èƒ½è¿›è¡Œ pop æ“ä½œ
   */
  isEmpty() {
    return this.heap.length === 0;
  }

  /**
   * è·å–å †é¡¶å…ƒç´ ï¼ˆä¸åˆ é™¤ï¼‰
   * å †é¡¶å…ƒç´ æ˜¯æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ 
   * æœ€å°å †ï¼šå †é¡¶æ˜¯æœ€å°å€¼
   * æœ€å¤§å †ï¼šå †é¡¶æ˜¯æœ€å¤§å€¼
   */
  peek() {
    return this.heap[0];
  }

  /**
   * æ’å…¥å…ƒç´ 
   * æ­¥éª¤ï¼š
   * 1. å°†æ–°å…ƒç´ æ·»åŠ åˆ°æ•°ç»„æœ«å°¾
   * 2. å‘ä¸Šè°ƒæ•´å †ï¼Œæ¢å¤å †åºæ€§è´¨
   * 
   * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
   */
  push(value) {
    this.heap.push(value);                    // æ·»åŠ åˆ°æœ«å°¾
    this.heapifyUp(this.heap.length - 1);     // å‘ä¸Šè°ƒæ•´
  }

  /**
   * åˆ é™¤å †é¡¶å…ƒç´ 
   * æ­¥éª¤ï¼š
   * 1. ä¿å­˜å †é¡¶å…ƒç´ 
   * 2. å°†æœ€åä¸€ä¸ªå…ƒç´ ç§»åˆ°å †é¡¶
   * 3. å‘ä¸‹è°ƒæ•´å †ï¼Œæ¢å¤å †åºæ€§è´¨
   * 
   * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
   */
  pop() {
    const top = this.heap[0];                 // ä¿å­˜å †é¡¶
    const last = this.heap.pop();             // å–å‡ºæœ€åä¸€ä¸ªå…ƒç´ 
    
    if (this.heap.length > 0) {
      this.heap[0] = last;                    // å°†æœ€åä¸€ä¸ªå…ƒç´ ç§»åˆ°å †é¡¶
      this.heapifyDown(0);                    // å‘ä¸‹è°ƒæ•´
    }
    
    return top;
  }

  /**
   * å‘ä¸Šè°ƒæ•´å †ï¼ˆæ’å…¥æ—¶ä½¿ç”¨ï¼‰
   * åŸç†ï¼šæ–°æ’å…¥çš„å…ƒç´ å¯èƒ½è¿åå †åºæ€§è´¨ï¼Œéœ€è¦å‘ä¸Šè°ƒæ•´
   * 
   * æ­¥éª¤ï¼š
   * 1. æ¯”è¾ƒå½“å‰èŠ‚ç‚¹ä¸çˆ¶èŠ‚ç‚¹
   * 2. å¦‚æœè¿åå †åºæ€§è´¨ï¼Œäº¤æ¢ä½ç½®
   * 3. ç»§ç»­å‘ä¸Šè°ƒæ•´ï¼Œç›´åˆ°æ»¡è¶³å †åºæ€§è´¨
   * 
   * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
   */
  heapifyUp(index) {
    while (index > 0) {                       // ç›´åˆ°åˆ°è¾¾æ ¹èŠ‚ç‚¹
      const parent = Math.floor((index - 1) / 2);  // è®¡ç®—çˆ¶èŠ‚ç‚¹ç´¢å¼•
      
      if (this.shouldSwap(index, parent)) {   // å¦‚æœè¿åå †åºæ€§è´¨
        [this.heap[index], this.heap[parent]] = [this.heap[parent], this.heap[index]];  // äº¤æ¢
        index = parent;                       // ç»§ç»­å‘ä¸Šè°ƒæ•´
      } else {
        break;                                // æ»¡è¶³å †åºæ€§è´¨ï¼Œé€€å‡º
      }
    }
  }

  /**
   * å‘ä¸‹è°ƒæ•´å †ï¼ˆåˆ é™¤æ—¶ä½¿ç”¨ï¼‰
   * åŸç†ï¼šåˆ é™¤å †é¡¶åï¼Œæ–°çš„å †é¡¶å¯èƒ½è¿åå †åºæ€§è´¨ï¼Œéœ€è¦å‘ä¸‹è°ƒæ•´
   * 
   * æ­¥éª¤ï¼š
   * 1. æ¯”è¾ƒå½“å‰èŠ‚ç‚¹ä¸å·¦å³å­èŠ‚ç‚¹
   * 2. æ‰¾åˆ°åº”è¯¥äº¤æ¢çš„å­èŠ‚ç‚¹
   * 3. äº¤æ¢ä½ç½®ï¼Œç»§ç»­å‘ä¸‹è°ƒæ•´
   * 
   * æ—¶é—´å¤æ‚åº¦ï¼šO(log n)
   */
  heapifyDown(index) {
    const n = this.heap.length;
    
    while (index < n) {                       // ç›´åˆ°åˆ°è¾¾å¶å­èŠ‚ç‚¹
      let target = index;                     // ç›®æ ‡èŠ‚ç‚¹ï¼ˆå½“å‰èŠ‚ç‚¹ï¼‰
      const left = 2 * index + 1;             // å·¦å­èŠ‚ç‚¹ç´¢å¼•
      const right = 2 * index + 2;            // å³å­èŠ‚ç‚¹ç´¢å¼•
      
      // æ¯”è¾ƒå·¦å­èŠ‚ç‚¹
      if (left < n && this.shouldSwap(left, target)) {
        target = left;
      }
      
      // æ¯”è¾ƒå³å­èŠ‚ç‚¹
      if (right < n && this.shouldSwap(right, target)) {
        target = right;
      }
      
      if (target === index) break;            // æ»¡è¶³å †åºæ€§è´¨ï¼Œé€€å‡º
      
      // äº¤æ¢ä½ç½®
      [this.heap[index], this.heap[target]] = [this.heap[target], this.heap[index]];
      index = target;                         // ç»§ç»­å‘ä¸‹è°ƒæ•´
    }
  }

  /**
   * åˆ¤æ–­æ˜¯å¦åº”è¯¥äº¤æ¢
   * è¿™æ˜¯å®ç°æœ€å¤§å †å’Œæœ€å°å †çš„å…³é”®å‡½æ•°
   * 
   * æœ€å°å †ï¼šå­èŠ‚ç‚¹ < çˆ¶èŠ‚ç‚¹æ—¶äº¤æ¢
   * æœ€å¤§å †ï¼šå­èŠ‚ç‚¹ > çˆ¶èŠ‚ç‚¹æ—¶äº¤æ¢
   * 
   * å‚æ•°è¯´æ˜ï¼š
   * @param {number} child - å­èŠ‚ç‚¹ç´¢å¼•
   * @param {number} parent - çˆ¶èŠ‚ç‚¹ç´¢å¼•
   * @returns {boolean} æ˜¯å¦åº”è¯¥äº¤æ¢
   */
  shouldSwap(child, parent) {
    if (this.isMinHeap) {
      // æœ€å°å †ï¼šå­èŠ‚ç‚¹å°äºçˆ¶èŠ‚ç‚¹æ—¶äº¤æ¢
      return this.heap[child] < this.heap[parent];
    } else {
      // æœ€å¤§å †ï¼šå­èŠ‚ç‚¹å¤§äºçˆ¶èŠ‚ç‚¹æ—¶äº¤æ¢
      return this.heap[child] > this.heap[parent];
    }
  }
}

// ==================== ä¾¿æ·åˆ›å»ºå‡½æ•° ====================

/**
 * åˆ›å»ºæœ€å°å †
 * æœ€å°å †ï¼šçˆ¶èŠ‚ç‚¹æ€»æ˜¯å°äºç­‰äºå­èŠ‚ç‚¹
 * å †é¡¶å…ƒç´ æ˜¯æœ€å°å€¼
 * 
 * åº”ç”¨åœºæ™¯ï¼š
 * - æ‰¾ç¬¬Kå¤§å…ƒç´ 
 * - åˆå¹¶Kä¸ªæœ‰åºé“¾è¡¨
 * - ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆä¼˜å…ˆçº§å°çš„å…ˆå‡ºï¼‰
 */
function createMinHeap() {
  return new SimpleHeap(true);
}

/**
 * åˆ›å»ºæœ€å¤§å †
 * æœ€å¤§å †ï¼šçˆ¶èŠ‚ç‚¹æ€»æ˜¯å¤§äºç­‰äºå­èŠ‚ç‚¹
 * å †é¡¶å…ƒç´ æ˜¯æœ€å¤§å€¼
 * 
 * åº”ç”¨åœºæ™¯ï¼š
 * - æ‰¾ç¬¬Kå°å…ƒç´ 
 * - ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆä¼˜å…ˆçº§å¤§çš„å…ˆå‡ºï¼‰
 * - å †æ’åºï¼ˆå‡åºï¼‰
 */
function createMaxHeap() {
  return new SimpleHeap(false);
}

// ==================== TOPK åº”ç”¨ ====================

/**
 * æ‰¾ç¬¬Kå¤§å…ƒç´ 
 * 
 * æ ¸å¿ƒæ€æƒ³ï¼šç»´æŠ¤ä¸€ä¸ªå¤§å°ä¸ºKçš„æœ€å°å †
 * ä¸ºä»€ä¹ˆç”¨æœ€å°å †ï¼Ÿ
 * - å †é¡¶æ˜¯å½“å‰Kä¸ªå…ƒç´ ä¸­çš„æœ€å°å€¼
 * - å¦‚æœæ–°å…ƒç´ æ¯”å †é¡¶å¤§ï¼Œè¯´æ˜å®ƒå¯èƒ½æ˜¯ç¬¬Kå¤§å…ƒç´ 
 * - æ›¿æ¢å †é¡¶åï¼Œå †é¡¶ä»ç„¶æ˜¯ç¬¬Kå¤§å…ƒç´ 
 * 
 * ç®—æ³•æ­¥éª¤ï¼š
 * 1. éå†æ•°ç»„ï¼Œç»´æŠ¤å¤§å°ä¸ºKçš„æœ€å°å †
 * 2. å¦‚æœå †æœªæ»¡ï¼Œç›´æ¥æ’å…¥
 * 3. å¦‚æœå †å·²æ»¡ä¸”æ–°å…ƒç´ æ¯”å †é¡¶å¤§ï¼Œæ›¿æ¢å †é¡¶
 * 4. æœ€åå †é¡¶å°±æ˜¯ç¬¬Kå¤§å…ƒç´ 
 * 
 * æ—¶é—´å¤æ‚åº¦ï¼šO(n log k)
 * ç©ºé—´å¤æ‚åº¦ï¼šO(k)
 * 
 * @param {number[]} nums - æ•°ç»„
 * @param {number} k - Kå€¼
 * @returns {number} ç¬¬Kå¤§å…ƒç´ 
 */
function findKthLargest(nums, k) {
  const minHeap = createMinHeap();  // åˆ›å»ºæœ€å°å †
  
  for (let num of nums) {
    if (minHeap.size < k) {
      // å †æœªæ»¡ï¼Œç›´æ¥æ’å…¥
      minHeap.push(num);
    } else if (num > minHeap.peek()) {
      // å †å·²æ»¡ä¸”æ–°å…ƒç´ æ¯”å †é¡¶å¤§ï¼Œæ›¿æ¢å †é¡¶
      minHeap.pop();      // åˆ é™¤å †é¡¶ï¼ˆæœ€å°çš„å…ƒç´ ï¼‰
      minHeap.push(num);  // æ’å…¥æ–°å…ƒç´ 
    }
    // å¦‚æœæ–°å…ƒç´  <= å †é¡¶ï¼Œå¿½ç•¥ï¼ˆä¸å¯èƒ½æ˜¯ç¬¬Kå¤§ï¼‰
  }
  
  return minHeap.peek();  // å †é¡¶å°±æ˜¯ç¬¬Kå¤§å…ƒç´ 
}

/**
 * æ‰¾ç¬¬Kå°å…ƒç´ 
 * 
 * æ ¸å¿ƒæ€æƒ³ï¼šç»´æŠ¤ä¸€ä¸ªå¤§å°ä¸ºKçš„æœ€å¤§å †
 * ä¸ºä»€ä¹ˆç”¨æœ€å¤§å †ï¼Ÿ
 * - å †é¡¶æ˜¯å½“å‰Kä¸ªå…ƒç´ ä¸­çš„æœ€å¤§å€¼
 * - å¦‚æœæ–°å…ƒç´ æ¯”å †é¡¶å°ï¼Œè¯´æ˜å®ƒå¯èƒ½æ˜¯ç¬¬Kå°å…ƒç´ 
 * - æ›¿æ¢å †é¡¶åï¼Œå †é¡¶ä»ç„¶æ˜¯ç¬¬Kå°å…ƒç´ 
 * 
 * ç®—æ³•æ­¥éª¤ï¼š
 * 1. éå†æ•°ç»„ï¼Œç»´æŠ¤å¤§å°ä¸ºKçš„æœ€å¤§å †
 * 2. å¦‚æœå †æœªæ»¡ï¼Œç›´æ¥æ’å…¥
 * 3. å¦‚æœå †å·²æ»¡ä¸”æ–°å…ƒç´ æ¯”å †é¡¶å°ï¼Œæ›¿æ¢å †é¡¶
 * 4. æœ€åå †é¡¶å°±æ˜¯ç¬¬Kå°å…ƒç´ 
 * 
 * æ—¶é—´å¤æ‚åº¦ï¼šO(n log k)
 * ç©ºé—´å¤æ‚åº¦ï¼šO(k)
 * 
 * @param {number[]} nums - æ•°ç»„
 * @param {number} k - Kå€¼
 * @returns {number} ç¬¬Kå°å…ƒç´ 
 */
function findKthSmallest(nums, k) {
  const maxHeap = createMaxHeap();  // åˆ›å»ºæœ€å¤§å †
  
  for (let num of nums) {
    if (maxHeap.size < k) {
      // å †æœªæ»¡ï¼Œç›´æ¥æ’å…¥
      maxHeap.push(num);
    } else if (num < maxHeap.peek()) {
      // å †å·²æ»¡ä¸”æ–°å…ƒç´ æ¯”å †é¡¶å°ï¼Œæ›¿æ¢å †é¡¶
      maxHeap.pop();      // åˆ é™¤å †é¡¶ï¼ˆæœ€å¤§çš„å…ƒç´ ï¼‰
      maxHeap.push(num);  // æ’å…¥æ–°å…ƒç´ 
    }
    // å¦‚æœæ–°å…ƒç´  >= å †é¡¶ï¼Œå¿½ç•¥ï¼ˆä¸å¯èƒ½æ˜¯ç¬¬Kå°ï¼‰
  }
  
  return maxHeap.peek();  // å †é¡¶å°±æ˜¯ç¬¬Kå°å…ƒç´ 
}

// ==================== æµ‹è¯• ====================

/**
 * æµ‹è¯•å †çš„åŸºæœ¬åŠŸèƒ½
 * æ¼”ç¤ºæœ€å°å †å’Œæœ€å¤§å †çš„å·¥ä½œåŸç†
 */
function test() {
  console.log('=== è¶…ç®€åŒ–å †æµ‹è¯• ===');
  
  // æµ‹è¯•æœ€å°å †
  console.log('\n--- æœ€å°å †æµ‹è¯• ---');
  const minHeap = createMinHeap();
  console.log('æ’å…¥å…ƒç´ : 3, 1, 4, 1, 5');
  
  minHeap.push(3);  // å †: [3]
  minHeap.push(1);  // å †: [1, 3] (1å‘ä¸Šè°ƒæ•´åˆ°å †é¡¶)
  minHeap.push(4);  // å †: [1, 3, 4] (4ä¸éœ€è¦è°ƒæ•´)
  minHeap.push(1);  // å †: [1, 1, 4, 3] (ç¬¬äºŒä¸ª1å‘ä¸Šè°ƒæ•´)
  minHeap.push(5);  // å †: [1, 1, 4, 3, 5] (5ä¸éœ€è¦è°ƒæ•´)
  
  console.log('æœ€å°å †:', minHeap.heap);
  console.log('å †é¡¶:', minHeap.peek());  // åº”è¯¥æ˜¯æœ€å°å€¼ 1
  console.log('åˆ é™¤å †é¡¶:', minHeap.pop());  // åˆ é™¤1ï¼Œæœ€åä¸€ä¸ªå…ƒç´ 5ç§»åˆ°å †é¡¶
  console.log('åˆ é™¤å:', minHeap.heap);  // å †: [1, 3, 4, 5] (5å‘ä¸‹è°ƒæ•´)
  
  // æµ‹è¯•æœ€å¤§å †
  console.log('\n--- æœ€å¤§å †æµ‹è¯• ---');
  const maxHeap = createMaxHeap();
  console.log('æ’å…¥å…ƒç´ : 3, 1, 4, 1, 5');
  
  maxHeap.push(3);  // å †: [3]
  maxHeap.push(1);  // å †: [3, 1] (1ä¸éœ€è¦è°ƒæ•´)
  maxHeap.push(4);  // å †: [4, 1, 3] (4å‘ä¸Šè°ƒæ•´åˆ°å †é¡¶)
  maxHeap.push(1);  // å †: [4, 1, 3, 1] (ç¬¬äºŒä¸ª1ä¸éœ€è¦è°ƒæ•´)
  maxHeap.push(5);  // å †: [5, 4, 3, 1, 1] (5å‘ä¸Šè°ƒæ•´åˆ°å †é¡¶)
  
  console.log('æœ€å¤§å †:', maxHeap.heap);
  console.log('å †é¡¶:', maxHeap.peek());  // åº”è¯¥æ˜¯æœ€å¤§å€¼ 5
  console.log('åˆ é™¤å †é¡¶:', maxHeap.pop());  // åˆ é™¤5ï¼Œæœ€åä¸€ä¸ªå…ƒç´ 1ç§»åˆ°å †é¡¶
  console.log('åˆ é™¤å:', maxHeap.heap);  // å †: [4, 1, 3, 1] (1å‘ä¸‹è°ƒæ•´)
  
  // æµ‹è¯•TOPKåº”ç”¨
  console.log('\n--- TOPK æµ‹è¯• ---');
  const nums = [3, 1, 4, 1, 5, 9, 2, 6, 5, 3];
  console.log('æ•°ç»„:', nums);
  console.log('ç¬¬3å¤§å…ƒç´ :', findKthLargest([...nums], 3));  // åº”è¯¥æ˜¯ 5
  console.log('ç¬¬3å°å…ƒç´ :', findKthSmallest([...nums], 3));  // åº”è¯¥æ˜¯ 2
}

// ==================== èƒŒè¯µè¦ç‚¹ ====================

/*
ğŸ§  å †çš„æ ¸å¿ƒæ¦‚å¿µï¼š

1. å †çš„å®šä¹‰ï¼š
   - å®Œå…¨äºŒå‰æ ‘ï¼šç”¨æ•°ç»„å­˜å‚¨ï¼Œæ»¡è¶³å®Œå…¨äºŒå‰æ ‘çš„æ€§è´¨
   - å †åºæ€§è´¨ï¼šçˆ¶èŠ‚ç‚¹æ€»æ˜¯å¤§äºï¼ˆæœ€å¤§å †ï¼‰æˆ–å°äºï¼ˆæœ€å°å †ï¼‰å­èŠ‚ç‚¹
   - å †é¡¶ï¼šæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ˜¯æœ€å€¼

2. æ•°ç»„ç´¢å¼•å…³ç³»ï¼ˆå…³é”®å…¬å¼ï¼‰ï¼š
   - çˆ¶èŠ‚ç‚¹ç´¢å¼•: Math.floor((index - 1) / 2)
   - å·¦å­èŠ‚ç‚¹ç´¢å¼•: 2 * index + 1
   - å³å­èŠ‚ç‚¹ç´¢å¼•: 2 * index + 2

3. å †çš„ç»´æŠ¤æ“ä½œï¼š
   - æ’å…¥ï¼šæ·»åŠ åˆ°æœ«å°¾ï¼Œå‘ä¸Šè°ƒæ•´
   - åˆ é™¤ï¼šåˆ é™¤å †é¡¶ï¼Œå°†æœ€åä¸€ä¸ªå…ƒç´ ç§»åˆ°å †é¡¶ï¼Œå‘ä¸‹è°ƒæ•´
   - å‘ä¸Šè°ƒæ•´ï¼šä¸çˆ¶èŠ‚ç‚¹æ¯”è¾ƒï¼Œè¿åå †åºæ€§è´¨åˆ™äº¤æ¢
   - å‘ä¸‹è°ƒæ•´ï¼šä¸å­èŠ‚ç‚¹æ¯”è¾ƒï¼Œæ‰¾åˆ°åº”è¯¥äº¤æ¢çš„å­èŠ‚ç‚¹

4. æœ€å¤§å † vs æœ€å°å †ï¼š
   - æœ€å¤§å †ï¼šçˆ¶èŠ‚ç‚¹ >= å­èŠ‚ç‚¹ï¼Œå †é¡¶æ˜¯æœ€å¤§å€¼
   - æœ€å°å †ï¼šçˆ¶èŠ‚ç‚¹ <= å­èŠ‚ç‚¹ï¼Œå †é¡¶æ˜¯æœ€å°å€¼
   - å®ç°å·®å¼‚ï¼šshouldSwap å‡½æ•°çš„æ¯”è¾ƒé€»è¾‘ä¸åŒ

5. TOPK åº”ç”¨åŸç†ï¼š
   - ç¬¬Kå¤§å…ƒç´ ï¼šç»´æŠ¤å¤§å°ä¸ºKçš„æœ€å°å †
     * å †é¡¶æ˜¯å½“å‰Kä¸ªå…ƒç´ ä¸­çš„æœ€å°å€¼
     * æ–°å…ƒç´ æ¯”å †é¡¶å¤§æ—¶ï¼Œæ›¿æ¢å †é¡¶
     * æœ€åå †é¡¶å°±æ˜¯ç¬¬Kå¤§å…ƒç´ 
   - ç¬¬Kå°å…ƒç´ ï¼šç»´æŠ¤å¤§å°ä¸ºKçš„æœ€å¤§å †
     * å †é¡¶æ˜¯å½“å‰Kä¸ªå…ƒç´ ä¸­çš„æœ€å¤§å€¼
     * æ–°å…ƒç´ æ¯”å †é¡¶å°æ—¶ï¼Œæ›¿æ¢å †é¡¶
     * æœ€åå †é¡¶å°±æ˜¯ç¬¬Kå°å…ƒç´ 

ğŸ¯ é¢è¯•èƒŒè¯µé¡ºåºï¼š

1. å…ˆå†™æ„é€ å‡½æ•°ï¼š
   ```javascript
   constructor(isMinHeap = true) {
     this.heap = [];
     this.isMinHeap = isMinHeap;
   }
   ```

2. å†å†™åŸºæœ¬æ–¹æ³•ï¼š
   ```javascript
   get size() { return this.heap.length; }
   isEmpty() { return this.heap.length === 0; }
   peek() { return this.heap[0]; }
   ```

3. ç„¶åå†™æ ¸å¿ƒæ“ä½œï¼š
   ```javascript
   push(value) {
     this.heap.push(value);
     this.heapifyUp(this.heap.length - 1);
   }
   
   pop() {
     const top = this.heap[0];
     const last = this.heap.pop();
     if (this.heap.length > 0) {
       this.heap[0] = last;
       this.heapifyDown(0);
     }
     return top;
   }
   ```

4. æ¥ç€å†™è°ƒæ•´å‡½æ•°ï¼š
   ```javascript
   heapifyUp(index) {
     while (index > 0) {
       const parent = Math.floor((index - 1) / 2);
       if (this.shouldSwap(index, parent)) {
         [this.heap[index], this.heap[parent]] = [this.heap[parent], this.heap[index]];
         index = parent;
       } else {
         break;
       }
     }
   }
   
   heapifyDown(index) {
     const n = this.heap.length;
     while (index < n) {
       let target = index;
       const left = 2 * index + 1;
       const right = 2 * index + 2;
       
       if (left < n && this.shouldSwap(left, target)) target = left;
       if (right < n && this.shouldSwap(right, target)) target = right;
       
       if (target === index) break;
       
       [this.heap[index], this.heap[target]] = [this.heap[target], this.heap[index]];
       index = target;
     }
   }
   ```

5. æœ€åå†™åˆ¤æ–­å‡½æ•°ï¼š
   ```javascript
   shouldSwap(child, parent) {
     if (this.isMinHeap) {
       return this.heap[child] < this.heap[parent];
     } else {
       return this.heap[child] > this.heap[parent];
     }
   }
   ```

6. TOPK åº”ç”¨ï¼š
   ```javascript
   // ç¬¬Kå¤§å…ƒç´ 
   function findKthLargest(nums, k) {
     const minHeap = createMinHeap();
     for (let num of nums) {
       if (minHeap.size < k) {
         minHeap.push(num);
       } else if (num > minHeap.peek()) {
         minHeap.pop();
         minHeap.push(num);
       }
     }
     return minHeap.peek();
   }
   ```

ğŸ’¡ è®°å¿†æŠ€å·§ï¼š
1. è®°ä½å…³é”®å…¬å¼ï¼šçˆ¶èŠ‚ç‚¹ã€å­èŠ‚ç‚¹ç´¢å¼•è®¡ç®—
2. è®°ä½äº¤æ¢é€»è¾‘ï¼šæœ€å°å † < äº¤æ¢ï¼Œæœ€å¤§å † > äº¤æ¢
3. è®°ä½TOPKåŸç†ï¼šç¬¬Kå¤§ç”¨æœ€å°å †ï¼Œç¬¬Kå°ç”¨æœ€å¤§å †
4. è®°ä½è°ƒæ•´æ–¹å‘ï¼šæ’å…¥å‘ä¸Šè°ƒæ•´ï¼Œåˆ é™¤å‘ä¸‹è°ƒæ•´
5. è®°ä½æ—¶é—´å¤æ‚åº¦ï¼šO(log n) è°ƒæ•´ï¼ŒO(n log k) TOPK

ğŸš€ é¢è¯•ä¼˜åŠ¿ï¼š
- ä»£ç ç®€æ´ï¼Œé€»è¾‘æ¸…æ™°
- æ³¨é‡Šè¯¦ç»†ï¼Œæ˜“äºç†è§£
- åº”ç”¨å¹¿æ³›ï¼Œå®ç”¨æ€§å¼º
- å¤æ‚åº¦ç¨³å®šï¼Œæ€§èƒ½å¯é 
*/

// è¿è¡Œæµ‹è¯•
test();

// å¯¼å‡º
export {
  SimpleHeap,
  createMinHeap,
  createMaxHeap,
  findKthLargest,
  findKthSmallest
};
