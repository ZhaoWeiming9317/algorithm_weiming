# ç»„åˆ vs æ’åˆ—ï¼šæ ¸å¿ƒåŒºåˆ«ä¸å¸¸è§å›°æƒ‘è§£ç­”

## ä¸€ã€ä½ çš„é—®é¢˜è§£ç­”

### é—®é¢˜1ï¼šç”µè¯å·ç å­—æ¯ç»„åˆä¸­ï¼Œä¸ºä»€ä¹ˆ `backtrack(index + 1)`ï¼Ÿ

```javascript
function letterCombinations(digits) {
    const phoneMap = {
        '2': 'abc',
        '3': 'def',
        // ...
    };
    
    function backtrack(index) {
        if (index === digits.length) {
            result.push(path.join(''));
            return;
        }
        
        const letters = phoneMap[digits[index]];
        
        for (let letter of letters) {
            path.push(letter);
            backtrack(index + 1);  // ä¸ºä»€ä¹ˆ +1ï¼Ÿ
            path.pop();
        }
    }
}
```

**ç­”æ¡ˆï¼š`index` ä»£è¡¨çš„æ˜¯"æˆ‘æ­£åœ¨å¤„ç†è¾“å…¥å­—ç¬¦ä¸²çš„ç¬¬å‡ ä¸ªæ•°å­—"ï¼Œä¸æ˜¯æ•°ç»„ç´¢å¼•ï¼**

#### è¯¦ç»†è§£é‡Š

å‡è®¾è¾“å…¥æ˜¯ `digits = "23"`ï¼š

```
digits[0] = '2' -> å¯¹åº”å­—æ¯ 'abc'
digits[1] = '3' -> å¯¹åº”å­—æ¯ 'def'

å›æº¯æ ‘ï¼š
                     root
                    /  |  \
                   a   b   c      (å¤„ç† digits[0]='2')
                 / | \ 
                d  e  f            (å¤„ç† digits[1]='3')
              
ç»“æœï¼š["ad", "ae", "af", "bd", "be", "bf", "cd", "ce", "cf"]
```

- `index = 0`ï¼šå¤„ç†ç¬¬1ä¸ªæ•°å­— '2'ï¼Œéå† 'abc'
- `index = 1`ï¼šå¤„ç†ç¬¬2ä¸ªæ•°å­— '3'ï¼Œéå† 'def'
- `index = 2`ï¼šç­‰äº `digits.length`ï¼Œæ”¶é›†ç»“æœ

**å…³é”®ç†è§£**ï¼šè¿™é“é¢˜æ˜¯**çºµå‘é€’è¿›**ï¼Œä¸æ˜¯æ¨ªå‘é€‰æ‹©ï¼
- æ¯ä¸€å±‚å¤„ç†ä¸€ä¸ªå›ºå®šçš„æ•°å­—ä½ç½®
- ä¸å­˜åœ¨"è·³è¿‡æŸä¸ªæ•°å­—"çš„æƒ…å†µ
- æ‰€ä»¥å¿…é¡» `index + 1`ï¼Œç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªæ•°å­—ä½ç½®

---

## äºŒã€æ’åˆ— vs ç»„åˆï¼šæœ¬è´¨åŒºåˆ«

### æ ¸å¿ƒåŒºåˆ«ï¼šæ˜¯å¦è€ƒè™‘é¡ºåº

```javascript
// ä¾‹å­ï¼šä» [1, 2, 3] ä¸­é€‰ 2 ä¸ªæ•°

// ã€ç»„åˆã€‘ä¸è€ƒè™‘é¡ºåº
[1, 2] å’Œ [2, 1] æ˜¯åŒä¸€ä¸ªç»„åˆ
ç»“æœï¼š[1,2], [1,3], [2,3]  // åªæœ‰ 3 ä¸ª

// ã€æ’åˆ—ã€‘è€ƒè™‘é¡ºåº
[1, 2] å’Œ [2, 1] æ˜¯ä¸åŒçš„æ’åˆ—
ç»“æœï¼š[1,2], [1,3], [2,1], [2,3], [3,1], [3,2]  // æœ‰ 6 ä¸ª
```

### ä»£ç å¯¹æ¯”

#### ç»„åˆä»£ç 
```javascript
function combine(n, k) {
    const result = [];
    const path = [];
    
    function backtrack(start) {  // âœ… æœ‰ start å‚æ•°
        if (path.length === k) {
            result.push([...path]);
            return;
        }
        
        for (let i = start; i <= n; i++) {  // âœ… ä» start å¼€å§‹
            path.push(i);
            backtrack(i + 1);  // âœ… ä¼ å…¥ i+1ï¼Œé¿å…é‡å¤é€‰æ‹©
            path.pop();
        }
    }
    
    backtrack(1);
    return result;
}

// combine(4, 2) â†’ [[1,2], [1,3], [1,4], [2,3], [2,4], [3,4]]
```

#### æ’åˆ—ä»£ç 
```javascript
function permute(nums) {
    const result = [];
    const path = [];
    const used = new Array(nums.length).fill(false);  // âœ… ä½¿ç”¨ used æ•°ç»„
    
    function backtrack() {  // âŒ æ²¡æœ‰ start å‚æ•°
        if (path.length === nums.length) {
            result.push([...path]);
            return;
        }
        
        for (let i = 0; i < nums.length; i++) {  // âœ… æ¯æ¬¡éƒ½ä» 0 å¼€å§‹
            if (used[i]) continue;  // âœ… è·³è¿‡å·²ä½¿ç”¨çš„
            
            path.push(nums[i]);
            used[i] = true;
            backtrack();  // âœ… ä¸ä¼  startï¼Œæ¯æ¬¡éƒ½éå†å…¨éƒ¨
            path.pop();
            used[i] = false;
        }
    }
    
    backtrack();
    return result;
}

// permute([1,2,3]) â†’ [[1,2,3], [1,3,2], [2,1,3], [2,3,1], [3,1,2], [3,2,1]]
```

### å…³é”®å·®å¼‚æ€»ç»“

| ç‰¹æ€§           | ç»„åˆ (Combination)      | æ’åˆ— (Permutation)      |
|:--------------|:-----------------------|:-----------------------|
| **é¡ºåº**       | ä¸è€ƒè™‘é¡ºåº               | è€ƒè™‘é¡ºåº                |
| **å‚æ•°**       | æœ‰ `start` å‚æ•°         | æ²¡æœ‰ `start` å‚æ•°       |
| **å¾ªç¯èµ·ç‚¹**    | ä» `start` å¼€å§‹         | æ¯æ¬¡éƒ½ä» `0` å¼€å§‹        |
| **ä¸‹å±‚è°ƒç”¨**    | `backtrack(i + 1)`     | `backtrack()`          |
| **é˜²é‡å¤**      | ç”¨ `start` æ§åˆ¶         | ç”¨ `used[]` æ•°ç»„        |
| **èƒ½å¦é‡å¤é€‰**  | çœ‹é¢˜ç›®è¦æ±‚               | é€šå¸¸ä¸èƒ½                |
| **ç¤ºä¾‹**       | [1,2] = [2,1]          | [1,2] â‰  [2,1]          |

---

## ä¸‰ã€"ä¸€ä¸ªå€¼åªèƒ½é€‰æ‹©ä¸€æ¬¡"çš„å«ä¹‰

### é—®é¢˜ï¼šç»„åˆæ˜¯ä¸€ä¸ªå€¼åªèƒ½é€‰æ‹©ä¸€æ¬¡å—ï¼Ÿ

**ç­”æ¡ˆï¼šä¸ä¸€å®šï¼å–å†³äºé¢˜ç›®è¦æ±‚**

#### æƒ…å†µ1ï¼šæ¯ä¸ªå€¼åªèƒ½ç”¨ä¸€æ¬¡ï¼ˆç»å…¸ç»„åˆï¼‰

```javascript
function combine(n, k) {
    function backtrack(start) {
        // ...
        for (let i = start; i <= n; i++) {
            path.push(i);
            backtrack(i + 1);  // i+1 è¡¨ç¤ºä¸‹ä¸€ä¸ªæ•°å¿…é¡»å¤§äºå½“å‰æ•°
            path.pop();
        }
    }
}

// combine(4, 2) â†’ [[1,2], [1,3], [1,4], [2,3], [2,4], [3,4]]
// æ³¨æ„ï¼šæ²¡æœ‰ [1,1] æˆ– [2,2]
```

#### æƒ…å†µ2ï¼šæ¯ä¸ªå€¼å¯ä»¥é‡å¤ä½¿ç”¨ï¼ˆç»„åˆæ€»å’Œï¼‰

```javascript
function combinationSum(candidates, target) {
    function backtrack(start, sum) {
        if (sum === target) {
            result.push([...path]);
            return;
        }
        
        for (let i = start; i < candidates.length; i++) {
            path.push(candidates[i]);
            backtrack(i, sum + candidates[i]);  // ä¼ å…¥ i è€Œä¸æ˜¯ i+1ï¼
            path.pop();
        }
    }
}

// combinationSum([2,3,6,7], 7) â†’ [[2,2,3], [7]]
// æ³¨æ„ï¼šå¯ä»¥æœ‰ [2,2,3]ï¼Œé‡å¤ä½¿ç”¨ 2
```

**å…³é”®åŒºåˆ«**ï¼š
- `backtrack(i + 1)`ï¼šä¸‹æ¬¡ä» i+1 å¼€å§‹ï¼Œ**ä¸èƒ½å†é€‰ i**
- `backtrack(i)`ï¼šä¸‹æ¬¡ä» i å¼€å§‹ï¼Œ**å¯ä»¥å†é€‰ i**

---

## å››ã€"å»é‡"çš„ä¸¤ç§ä¸åŒå«ä¹‰

### å›°æƒ‘ï¼šä¸ºä»€ä¹ˆæ’åˆ—å’Œç»„åˆéƒ½æœ‰å»é‡ï¼Ÿ

**ç­”æ¡ˆï¼šä¸¤ç§å»é‡çš„åœºæ™¯å®Œå…¨ä¸åŒï¼**

### åœºæ™¯1ï¼šç»„åˆçš„å»é‡ï¼ˆè¾“å…¥æ•°ç»„æœ‰é‡å¤å…ƒç´ ï¼‰

```javascript
// è¾“å…¥: candidates = [1, 1, 2], target = 3
// æœŸæœ›è¾“å‡º: [[1, 2]] 
// é”™è¯¯è¾“å‡º: [[1, 2], [1, 2]]  â† ä¸¤ä¸ª [1,2] é‡å¤äº†ï¼

function combinationSum2(candidates, target) {
    candidates.sort((a, b) => a - b);  // å…ˆæ’åº
    
    function backtrack(start, sum) {
        if (sum === target) {
            result.push([...path]);
            return;
        }
        
        for (let i = start; i < candidates.length; i++) {
            // âœ… åŒä¸€å±‚çº§è·³è¿‡é‡å¤å…ƒç´ 
            if (i > start && candidates[i] === candidates[i - 1]) {
                continue;
            }
            
            path.push(candidates[i]);
            backtrack(i + 1, sum + candidates[i]);
            path.pop();
        }
    }
}
```

**ç»„åˆå»é‡çš„ç›®çš„**ï¼šé¿å…ç»“æœé›†ä¸­å‡ºç°é‡å¤çš„ç»„åˆ

```
è¾“å…¥: [1, 1, 2], å–2ä¸ªæ•°
ä¸å»é‡: [[1,1], [1,2], [1,2]]  â† æœ‰ä¸¤ä¸ª [1,2]
å»é‡å: [[1,1], [1,2]]        â† æ­£ç¡®
```

### åœºæ™¯2ï¼šæ’åˆ—çš„å»é‡ï¼ˆè¾“å…¥æ•°ç»„æœ‰é‡å¤å…ƒç´ ï¼‰

```javascript
// è¾“å…¥: [1, 1, 2]
// æœŸæœ›è¾“å‡º: [[1,1,2], [1,2,1], [2,1,1]]
// é”™è¯¯è¾“å‡º: [[1,1,2], [1,2,1], [1,1,2], [1,2,1], [2,1,1], [2,1,1]]

function permuteUnique(nums) {
    nums.sort((a, b) => a - b);
    const used = new Array(nums.length).fill(false);
    
    function backtrack() {
        if (path.length === nums.length) {
            result.push([...path]);
            return;
        }
        
        for (let i = 0; i < nums.length; i++) {
            if (used[i]) continue;
            
            // âœ… å»é‡ï¼šç›¸åŒå…ƒç´ å¿…é¡»æŒ‰é¡ºåºä½¿ç”¨
            if (i > 0 && nums[i] === nums[i-1] && !used[i-1]) {
                continue;
            }
            
            path.push(nums[i]);
            used[i] = true;
            backtrack();
            path.pop();
            used[i] = false;
        }
    }
}
```

**æ’åˆ—å»é‡çš„ç›®çš„**ï¼šé¿å…ç»“æœé›†ä¸­å‡ºç°é‡å¤çš„æ’åˆ—

```
è¾“å…¥: [1, 1, 2]
ä¸å»é‡: [[1,1,2], [1,2,1], [1,1,2], [1,2,1], [2,1,1], [2,1,1]]
å»é‡å: [[1,1,2], [1,2,1], [2,1,1]]
```

### å»é‡é€»è¾‘å¯¹æ¯”

| ç±»å‹         | å»é‡æ¡ä»¶                                          | ç›®çš„                  |
|:------------|:------------------------------------------------|:---------------------|
| **ç»„åˆå»é‡**  | `i > start && nums[i] === nums[i-1]`           | åŒä¸€å±‚çº§è·³è¿‡é‡å¤å…ƒç´     |
| **æ’åˆ—å»é‡**  | `i > 0 && nums[i] === nums[i-1] && !used[i-1]` | ç›¸åŒå…ƒç´ æŒ‰é¡ºåºä½¿ç”¨      |
| **å…±åŒç‚¹**    | éƒ½éœ€è¦å…ˆæ’åº                                      | è®©ç›¸åŒå…ƒç´ ç›¸é‚»         |

---

## äº”ã€å›¾è§£ï¼šä¸‰ç§æƒ…å†µçš„é€’å½’æ ‘å¯¹æ¯”

### 1. ç”µè¯å·ç å­—æ¯ç»„åˆï¼ˆçºµå‘é€’è¿›ï¼‰

```
è¾“å…¥: "23"

                    root (index=0)
                   /  |  \
                  a   b   c         å¤„ç† digits[0]='2'
                / | \ 
               d  e  f              å¤„ç† digits[1]='3'
             
è·¯å¾„: ["ad", "ae", "af", "bd", "be", "bf", "cd", "ce", "cf"]

ç‰¹ç‚¹ï¼š
- index çºµå‘é€’è¿›ï¼ˆ0 â†’ 1 â†’ 2ï¼‰
- æ¯å±‚å¤„ç†ä¸€ä¸ªå›ºå®šä½ç½®çš„æ•°å­—
- ä¸å­˜åœ¨"é€‰ä¸é€‰"çš„é—®é¢˜ï¼Œå¿…é¡»é€‰
```

### 2. ç»„åˆï¼ˆæ¨ªå‘é€‰æ‹©ï¼Œstart æ§åˆ¶ï¼‰

```
è¾“å…¥: [1,2,3], k=2

                         []
                    /    |    \
                  [1]   [2]   [3]        start=1,2,3
                 / \      |
              [1,2] [1,3] [2,3]          start=2,3,3

ç»“æœ: [[1,2], [1,3], [2,3]]

ç‰¹ç‚¹ï¼š
- start æ§åˆ¶æ¨ªå‘é€‰æ‹©èŒƒå›´
- åé¢çš„æ•°åªèƒ½é€‰æ›´å¤§çš„ï¼ˆi+1ï¼‰
- é¿å…äº† [2,1] è¿™ç§é‡å¤ç»„åˆ
```

### 3. æ’åˆ—ï¼ˆæ¨ªå‘é€‰æ‹©ï¼Œused æ§åˆ¶ï¼‰

```
è¾“å…¥: [1,2,3]

                              []
                    /         |         \
                  [1]        [2]        [3]
                 /   \      /   \      /   \
              [1,2] [1,3] [2,1] [2,3] [3,1] [3,2]
               |     |     |     |     |     |
            [1,2,3][1,3,2][2,1,3][2,3,1][3,1,2][3,2,1]

ç»“æœ: 6ä¸ªæ’åˆ—

ç‰¹ç‚¹ï¼š
- æ¯å±‚éƒ½ä»å¤´éå†å…¨éƒ¨å…ƒç´ 
- used[] æ ‡è®°å·²ä½¿ç”¨çš„å…ƒç´ 
- [1,2,3] å’Œ [1,3,2] æ˜¯ä¸åŒç»“æœ
```

---

## å…­ã€å¿«é€Ÿåˆ¤æ–­æŠ€å·§

å½“ä½ çœ‹åˆ°ä¸€é“å›æº¯é¢˜æ—¶ï¼Œå¦‚ä½•å¿«é€Ÿåˆ¤æ–­æ˜¯ç»„åˆè¿˜æ˜¯æ’åˆ—ï¼Ÿ

### åˆ¤æ–­æ ‡å‡†

1. **é¢˜ç›®è¦æ±‚é¡ºåºå—ï¼Ÿ**
   - ä¸è¦æ±‚é¡ºåº â†’ ç»„åˆï¼ˆå¦‚ï¼šæ‰¾å’Œä¸ºtargetçš„ç»„åˆï¼‰
   - è¦æ±‚é¡ºåº â†’ æ’åˆ—ï¼ˆå¦‚ï¼šç”Ÿæˆæ‰€æœ‰æ’åˆ—ï¼‰

2. **ä»£ç æœ‰ `start` å‚æ•°å—ï¼Ÿ**
   - æœ‰ â†’ ç»„åˆ
   - æ²¡æœ‰ â†’ æ’åˆ—

3. **é€’å½’è°ƒç”¨ä¼ ä»€ä¹ˆï¼Ÿ**
   - `backtrack(i + 1)` â†’ ç»„åˆï¼ˆæ¯ä¸ªå…ƒç´ ç”¨ä¸€æ¬¡ï¼‰
   - `backtrack(i)` â†’ ç»„åˆï¼ˆå…ƒç´ å¯é‡å¤ï¼‰
   - `backtrack()` â†’ æ’åˆ—

4. **ç”¨ä»€ä¹ˆé˜²é‡å¤ï¼Ÿ**
   - `start` å‚æ•° â†’ ç»„åˆ
   - `used[]` æ•°ç»„ â†’ æ’åˆ—

---

## ä¸ƒã€æ€»ç»“ï¼šä¸€å›¾èƒœåƒè¨€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å›æº¯é—®é¢˜åˆ†ç±»                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  ç”µè¯å·ç å­—æ¯ç»„åˆ                                         â”‚
â”‚  â”œâ”€ ç‰¹ç‚¹: çºµå‘é€’è¿›ï¼Œå¤„ç†ä¸åŒä½ç½®                          â”‚
â”‚  â”œâ”€ å‚æ•°: indexï¼ˆä½ç½®ç´¢å¼•ï¼‰                               â”‚
â”‚  â”œâ”€ é€’å½’: backtrack(index + 1)                           â”‚
â”‚  â””â”€ å…³é”®: index ä»£è¡¨"ç¬¬å‡ ä¸ªæ•°å­—"                          â”‚
â”‚                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚
â”‚                                                          â”‚
â”‚  ç»„åˆï¼ˆCombinationï¼‰                                     â”‚
â”‚  â”œâ”€ ç‰¹ç‚¹: ä¸è€ƒè™‘é¡ºåºï¼Œ[1,2]=[2,1]                        â”‚
â”‚  â”œâ”€ å‚æ•°: startï¼ˆèµ·å§‹ä½ç½®ï¼‰                               â”‚
â”‚  â”œâ”€ é€’å½’: backtrack(i+1) æˆ– backtrack(i)                 â”‚
â”‚  â”œâ”€ é˜²é‡: start å‚æ•°æ§åˆ¶èŒƒå›´                              â”‚
â”‚  â””â”€ å»é‡: i > start && nums[i] == nums[i-1]             â”‚
â”‚                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚
â”‚                                                          â”‚
â”‚  æ’åˆ—ï¼ˆPermutationï¼‰                                     â”‚
â”‚  â”œâ”€ ç‰¹ç‚¹: è€ƒè™‘é¡ºåºï¼Œ[1,2]â‰ [2,1]                          â”‚
â”‚  â”œâ”€ å‚æ•°: æ—  startï¼Œæ¯æ¬¡å…¨éå†                            â”‚
â”‚  â”œâ”€ é€’å½’: backtrack()                                    â”‚
â”‚  â”œâ”€ é˜²é‡: used[] æ•°ç»„æ ‡è®°                                 â”‚
â”‚  â””â”€ å»é‡: !used[i-1] && nums[i]==nums[i-1]              â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å…«ã€ç»ƒä¹ å»ºè®®

1. **å…ˆç†è§£æ¦‚å¿µ**ï¼šç»„åˆä¸è€ƒè™‘é¡ºåºï¼Œæ’åˆ—è€ƒè™‘é¡ºåº
2. **çœ‹ä»£ç ç»“æ„**ï¼šæœ‰æ—  start å‚æ•°ï¼Œé€’å½’ä¼ ä»€ä¹ˆ
3. **ç”»é€’å½’æ ‘**ï¼šè‡ªå·±ç”»ä¸€éï¼Œç†è§£ index/start çš„ä½œç”¨
4. **å¯¹æ¯”ç»ƒä¹ **ï¼šåŒä¸€ä¸ªè¾“å…¥ï¼Œåˆ†åˆ«ç”¨ç»„åˆå’Œæ’åˆ—è§£ï¼Œçœ‹ç»“æœå·®å¼‚

å¸Œæœ›è¿™ä¸ªæ–‡æ¡£èƒ½å¸®ä½ å½»åº•ç†è§£ç»„åˆå’Œæ’åˆ—çš„åŒºåˆ«ï¼ğŸ¯

